<!DOCTYPE html>
<html>
  <head>
    <script type="text/javascript" src="neural_network.js"></script>
    <script type="text/javascript" src="main.js"></script>
    <style>
      html {
        display: table;
        margin: auto;
      }

      body {
        display: table-cell;
        background: #eeeeee;
        font-family: arial;
      }

      p {
        width: 100%;
        max-width: 800px;
      }

      .wrapper {
        position: relative;
        z-index: 100;
        display: inline-block;
        margin-top: 15px;
        margin-left: 5px;
        margin-right: 5px;
        user-select:none;
        -webkit-user-select: none;
      }

      .digitCanvas {
        background: white;
      }

      #drawingCanvas {
        display: inline-block;
        position: relative;
        top: 0;
        left: 0;
        width: 300px;
        height: 300px;
        touch-action: none;
      }

      #clearBtn {
        position: absolute;
        width: 60px;
        height: 30px;
        line-height: 30px;
        left: 10px;
        top: 12px;
        z-index: 5;
        margin: 0 auto;

        font-size: 20px;
        border:1px solid #aaa;
        background:#ddd;
        cursor:pointer;
        user-select:none;
      }

      #clearBtn:hover {
        border:1px solid #444;
      }

      #clearBtn:active {
        border:1px solid #444;
        background:#aaa;
      }

      #pixelCanvas {
        width: 300px;
        height: 300px;
        image-rendering: pixelated;
      }

      #output {
        margin-top: 20px;
        font-size: 30px;
      }

      #networkCanvas {
        display: block;
        width: 666px;
        height: 466px;
        padding: 0;
        margin: auto;
        margin-top: 20px;
        display: block;
        image-rendering: auto;
      }

      .keySpan {
        padding-left: 40px;
        margin-right: 10px;
      }
    </style>
  </head>
  <body>
    <div style="text-align: center">
      <div class="wrapper">
        <canvas id="drawingCanvas" class="digitCanvas" width="300" height="300"></canvas>
        <div id="clearBtn">clear</div>
      </div>
      <div class="wrapper">
        <canvas id="pixelCanvas" class="digitCanvas" width="28" height="28"></canvas>
      </div>
    </div>
    <div style="text-align: center">
      <canvas id="networkCanvas" width="1000" height="700"></canvas>
      <div id="output">Guess: ?</div>
    </div>
    <div style="text-align: center; margin-top:40px; margin-bottom:0px;">
      <b>key:</b>
      <table style="margin: 0 auto;">
        <th>
          <td colspan="2"><b>neurons</b></td>
          <td colspan="2"><b>synapses</b></td>
        </th>
        <tr>
          <td>
            <span class="keySpan" style="background-color:#00ffff;"></span>
          </td>
          <td>strong activation</td>
          <td>
            <span class="keySpan" style="background-color:#00ffff;"></span>
          </td>
          <td>positive activation</td>
        </tr>
        <tr>
          <td>
            <span class="keySpan" style="background-color:#000000;"></span>
          </td>
          <td>zero activation</td>
          <td>
            <span class="keySpan" style="background-color:#000000;"></span>
          </td>
          <td>negative activation</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td>
            <span style="background-color:#dddddd;">&lt;opacity&gt;</span>
          </td>
          <td>activation strength</td>
        </tr>
      </table>
    </div>
    <h2>About:</h2>
    <p>
      This is a visualization of a neural net that classifies human handwritten digits (0-9).
      Training was implemented in Python and classification in Javascript so it can run in-browser.
      It's a vanilla deep(ish) feedforward neural network whith two hidden layers of 256 nuerons. It
      was trained on the
      <a href="https://github.com/ethanhjennings/emnist-simplified">EMNIST</a>
      handwriten digits dataset.
    </p>
    <p>
      The four white boxes on top illustrate the process of normalizing the images. This consists of
      finding the bounding box and centroid, compressing the cropped image to 20x20 pixels, and
      finally centering the image on the centroid in a 28x28 pixel square. The pixels of the final
      normalized image on the right are then fed into the input layer, and the classification guess
      is chosen by picking the highest value in the output layer.
    </p>
    <p>
      In the visualization, neuron layers are drawn as vertical stacks of as thin rectangles, and
      synapses as connecting lines. These are colored and shaded according to the key above. The
      network as drawn on an HTML canvas using javascript.
    </p>
    <a href="https://github.com/ethanhjennings/python-neural-net">
      View more info and source code on github.
    </a>
  </body>
</html>
